<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Search &middot; Startist</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="An online platform for talented users to collaborate on awesome projects">
    <meta name="author" content="cvstechnology">

    <link href="{{ url_for('static', filename='img/favicon.ico') }}" rel="shortcut icon" type="image/x-icon"/>
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ url_for('static', filename='css/bootstrap-responsive.min.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ url_for('static', filename='css/startist.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ url_for('static', filename='css/bootstrap-fileupload.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ url_for('static', filename='css/jquery.tagsinput.css') }}" rel="stylesheet" type="text/css"/>
  </head>
  
  <body>

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <a href="{{ url_for('home') }}"><img class="brand" src="{{ url_for('static', filename='img/startist.gif') }}"/></a>
        <div class="lander">
          <div class="nav-collapse collapse pull-right">
              <form class="navbar-search" action="{{ url_for('search', search="all") }}">
                <input type="text" name="search" class="search-query" placeholder="Search">
                <div class="icon-search" style="background-image:url('{{ url_for('static', filename='img/glyphicons-halflings.png') }}');"></div>
              </form>            
              <ul class="nav">
              {% if not session.logged_in %}
                <li><a href="{{ url_for('login') }}" data-toggle="modal">login</a></li>
                <li><a href="{{ url_for('join') }}" data-toggle="modal">join</a></li>
              {% else %}
                <li class="dropdown">
                  <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ session.name }} <b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li><a href="{{ url_for('user', username=session.username) }}">Profile</a></li>
                    <li><a href="{{ url_for('portfolio', username=session.username) }}">Portfolio</a></li>
                    <li class="divider"></li>
                    <li><a href="{{ url_for('logout') }}">Logout</a></li>
                  </ul>
                </li>
              {% endif %}
              </ul>
            </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-narrow">

    <section id="options">
        <h3>Filters</h3>
        <ul id="filters" class="option-set clearfix" data-option-key="filter">

          {% if search == "all" %}
          <li><a href="#filter" data-option-value="*" class="selected">show all</a></li>
          <li><a href="#filter" data-option-value=".profiles">profiles</a></li>
          <li><a href="#filter" data-option-value=".projects">projects</a></li>
          <li><a href="#filter" data-option-value=".portfolios">portfolios</a></li>
          {% endif %}
          {% if search == "profiles" %}
          <li><a href="#filter" data-option-value="*">show all</a></li>
          <li><a href="#filter" data-option-value=".profiles" class="selected">profiles</a></li>
          <li><a href="#filter" data-option-value=".projects">projects</a></li>
          <li><a href="#filter" data-option-value=".portfolios">portfolios</a></li>
          {% endif %}
          {% if search == "projects" %}
          <li><a href="#filter" data-option-value="*">show all</a></li>
          <li><a href="#filter" data-option-value=".profiles">profiles</a></li>
          <li><a href="#filter" data-option-value=".projects" class="selected">projects</a></li>
          <li><a href="#filter" data-option-value=".portfolios">portfolios</a></li>
          {% endif %}
          {% if search == "portfolios" %}
          <li><a href="#filter" data-option-value="*">show all</a></li>
          <li><a href="#filter" data-option-value=".profiles">profiles</a></li>
          <li><a href="#filter" data-option-value=".projects">projects</a></li>
          <li><a href="#filter" data-option-value=".portfolios" class="selected">portfolios</a></li>
          {% endif %}

        </ul>
    </section> <!-- #options --> 
  </div>

  <div id="container">
    {% for user in users %}
    <div class="box col2 profiles" data-category="profiles" id="{{ user.username }}">
      <div class="thumbnail">
        <a href="{{ url_for('user', username=user.username) }}"><img src="{{ process_image(user.pic) }}"/></a>
      </div>
      <p>{{ user.description }}</p>
    </div>
    {% endfor %}
    {% for project in projects %}
    <div class="box col2 projects" data-category="projects" id="{{ project.username }}/{{ project.id }}">
      <div class="thumbnail">
        <a href="{{ url_for('project', username=project.username, project_id=project.id) }}"><img src="{{ process_image(project.pic)}} "/></a>
      </div>
      <p>{{ project.description }}</p>
    </div>
    {% endfor %}
    {% for media in portfolios %}
    <div class="box col2 portfolios" data-category="portfolios" id="{{ media.id }}">
      <div class="thumbnail">
        <a href="{{ url_for('portfolio', username=media.username) }}"><img src="{{ process_image(media.id)}} "/></a>
      </div>
    </div>
    {% endfor %}

    </div>

  <script src="{{ url_for('static', filename='js/jquery.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/bootstrap-fileupload.min.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.tagsinput.js') }}"></script>
  <script src="{{ url_for('static', filename='js/jquery.isotope.min.js') }}"></script>
  <script>
    $(document).ready(function(){

     $(function(){
        
        var $container = $('#container');

        $container.imagesLoaded(function() {
          $container.isotope({
              itemSelector : '.box',
              transformsEnabled: false,
              containerStyle: { position: 'relative' },
              {% if search != 'all' %}
              filter: '.{{ search }}'
              {% endif %}
          });
        });

        var $optionSets = $('#options .option-set'),
            $optionLinks = $optionSets.find('a');

        $optionLinks.click(function(){
          var $this = $(this);
          // don't proceed if already selected
          if ( $this.hasClass('selected') ) {
            return false;
          }
          var $optionSet = $this.parents('.option-set');
          $optionSet.find('.selected').removeClass('selected');
          $this.addClass('selected');
    
          // make option object dynamically, i.e. { filter: '.my-filter-class' }
          var options = {},
              key = $optionSet.attr('data-option-key'),
              value = $this.attr('data-option-value');
          // parse 'false' as false boolean
          value = value === 'false' ? false : value;
          options[ key ] = value;
          if ( key === 'layoutMode' && typeof changeLayoutMode === 'function' ) {
            // changes in layout modes need extra logic
            changeLayoutMode( $this, options )
          } else {
            // otherwise, apply new options
            $container.isotope( options );
          }
          
          return false;
        });
      });
    });
  </script>

  </body>
</html>
